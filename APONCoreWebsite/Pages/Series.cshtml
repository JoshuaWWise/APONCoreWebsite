@page "/{SeriesName}"
@model APONCoreWebsite.Pages.SeriesModel
@{
    ViewData["Title"] = "Series";
}

<div class="card-border APONtext grid-row">
    <div id="mainSection" class="col-3-of-4">
        <div class="grid-row">
            <div  class="col-1-of-1 seriesContainer">
                <span>
                    <img *ngIf="series"
                         class="seriesContainer__premiumSeriesImage"
                         src=@Model.currentSeries.ImageURL />
                </span>
                <img id="showTwitterLink"
                     style="visibility: hidden"
                     src="https://media.allportsopen.org/images/siteImages/TwitterFeedLink.png"
                     class="twitterfeedLink"
                     onclick="switchTwitter()" />
                <div class="APONText seriesContainer__premiumSeriesDescription"
                     [innerHTML]=@Model.currentSeries.Description></div>
                <div class="grid-row seriesContainer__links">
                    <div class="col-1-of-4">
                        <button class="seriesContainer__links--cast" (click)="navToCast()">
                            Series Cast
                        </button>
                    </div>
                    <div class="col-1-of-4">
                        <a href=@Model.currentSeries.Spotify target="_blank">
                            <img class="seriesContainer__links--socialMedia"
                                 src="https://media.allportsopen.org/images/siteimages/spotifywb.png" />
                        </a>
                    </div>
                    <div class="col-1-of-4">
                        <a href=@Model.currentSeries.RSS target="_blank">
                            <img class="seriesContainer__links--socialMedia"
                                 src="https://media.allportsopen.org/images/siteimages/RSS.png" />
                        </a>
                    </div>
                    <div class="col-1-of-4">
                        <a href=@Model.currentSeries.ITunes target="_blank">
                            <img class="seriesContainer__links--socialMedia"
                                 src="https://media.allportsopen.org/images/siteimages/iTunes.png" />
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div *ngIf="isEditor()" class="editorControl">
            <div>
                <div class="editorControl__head">
                    Editor Tools
                </div>

                <div class="grid-row editorControl__body APONText">
                    <div class="col-1-of-3">
                        <button type="button"
                                (click)="onEditSeries()"
                                class="APONbtn APONbtnEditor">
                            Edit
                        </button>
                    </div>
                    <div class="col-1-of-3"></div>
                    <div class="col-1-of-3"></div>
                </div>
            </div>
        </div>

        <hr />
        <div class="row" *ngIf="seriesLinks">
            <div class="col-xs-3 col-md-3" *ngFor="let sl of seriesLinks">
                <app-series-link [seriesLink]="sl"></app-series-link>
            </div>
        </div>
        <hr />

        <hr />
        <div class="grid-row">
            <div class="col-1-of-1">
                <div >
                    <ngb-pagination class="pager d-flex justify-content-center"
                                    [(page)]="PageNum"
                                    [pageSize]="pageSize"
                                    [collectionSize]="Episodes.length"
                                    [maxSize]="5"
                                    [rotate]="true"
                                    [ellipses]="false"
                                    [boundaryLinks]="true"></ngb-pagination>

                    <div *ngFor="
              let ep of Episodes
                | slice
                  : (PageNum - 1) * pageSize
                  : (PageNum - 1) * pageSize + pageSize;
              index as i
            ">
                        <div *ngIf="i % 4 == 0" class="grid-row">
                            <div class="col-1-of-4"
                                 *ngIf="Episodes.length > i + (PageNum - 1) * pageSize">
                                <app-episode-list-item [episode]="Episodes[i + (PageNum - 1) * pageSize]">
                                </app-episode-list-item>
                            </div>
                            <div class="col-1-of-4"
                                 *ngIf="Episodes.length > i + 1 + (PageNum - 1) * pageSize">
                                <app-episode-list-item [episode]="Episodes[i + 1 + (PageNum - 1) * pageSize]">
                                </app-episode-list-item>
                            </div>
                            <div class="col-1-of-4"
                                 *ngIf="Episodes.length > i + 2 + (PageNum - 1) * pageSize">
                                <app-episode-list-item [episode]="Episodes[i + 2 + (PageNum - 1) * pageSize]">
                                </app-episode-list-item>
                            </div>
                            <div class="col-1-of-4"
                                 *ngIf="Episodes.length > i + 3 + (PageNum - 1) * pageSize">
                                <app-episode-list-item [episode]="Episodes[i + 3 + (PageNum - 1) * pageSize]">
                                </app-episode-list-item>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="!series" class="warning">Loading</div>
                </div>
            </div>
        </div>
    </div>
    <div id="twitterSection" class="col-1-of-4">
        <button onclick="switchTwitter()" class="APONbtn APONbtnBlue mt-2">
            Hide Feed
        </button>
        <a class="twitter-timeline" href=@Model.currentSeries.TwitterFeedURL>
            Twitter Feed
        </a>
    </div>
</div>

@section Scripts{

    <script type="text/javascript">

        var IsTwitterHidden = true;

        $(document).ready(function () {
            switchTwitter();
        });

        function switchTwitter() {
           
            IsTwitterHidden = !IsTwitterHidden;
          
            var mainSection = document.getElementById("mainSection");
            var twitterSection = document.getElementById("twitterSection");

            //Twitter is hidden
            if (IsTwitterHidden) {
                mainSection.classList.remove("col-3-of-4");
                mainSection.classList.add("col-1-of-1");
                twitterSection.style.visibility = "hidden";
                document.getElementById("showTwitterLink").style.visibility = "visible";
            }
            else {
           
                mainSection.classList.remove("col-1-of-1");
                mainSection.classList.add("col-3-of-4");
                twitterSection.style.visibility = "visible";
                document.getElementById("showTwitterLink").style.visibility = "hidden";
            }
        }

    </script>
}